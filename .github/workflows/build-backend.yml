name: Build-Backend
on: 
  pull_request:
    branches: [dev,main]
workflow_dispatch: {}

jobs: 
  build:
    runs_on: windows-latest

    steps:
      - name: Checkout source code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
          with:
            node-version: '16'  

      - name: Install Amplify CLI
        run: npm install -g @aws-amplify/cli

      - name: Build
        run: |
          amplify init  --projectName Pronto --appId {{secrets.APP_ID}} --envName {{secrets.ENV_NAME}} --defaultEditor Visual Studio --useProfile true --profileName {{secrets.PROFILE}}
          amplify pull
          amplify add api
          amplify mock api
